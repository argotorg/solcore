
forall a . class  a : Neg {
   function neg(x:a) -> a;
}

data B = F | T;

instance B : Neg {
  function neg (x : B) -> B {
    match x {
    | F => return T;
    | T => return F;
    }
  }
}

function fst (p) {
  match p {
  | (x,y) => return x;
  }
}

function snd(p) {
  match p {
    | (x,y) => return y;
  }
}


forall a b . a : Neg, b : Neg => instance (a,b):Neg {
  function neg(p : (a,b)) -> (a,b) {
    return (Neg.neg (fst(p)), Neg.neg(snd (p)));
  }
}

contract NegPair {

 function bnot(x: B) -> B{
   match x {
     | T => return F;
     | F => return T;
   }
}

 function fromB(b : B) -> word {
  match b  {
    | F => return 0;
    | T => return 1;
  }
}

 function main() -> word { return  fromB(fst(Neg.neg((F,T)))); }
}
